<!DOCTYPE html>
<html>
<head>
    <title>LegoTax Prepaid Insurance Calculator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #d4f1ff, #e8ffe8);
            color: #003366;
            transition: 0.5s;
        }
        .dark-mode {
            background: #121212;
            color: white;
        }
        .container {
            max-width: 900px;
            margin: 30px auto;
            background: rgba(255,255,255,0.8);
            padding: 25px;
            border-radius: 20px;
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
            transition: 0.5s;
        }
        .dark-mode .container {
            background: rgba(40,40,40,0.9);
            color: white;
        }
        input, button, select {
            width: 100%;
            padding: 10px;
            margin: 8px 0;
            border-radius: 10px;
            border: 1px solid #999;
            transition: 0.3s;
        }
        button:hover {
            transform: scale(1.05);
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        table, th, td {
            border: 1px solid #555;
            padding: 10px;
            text-align: center;
        }
        footer {
            text-align:center;
            margin-top:30px;
            padding:10px;
            color:#777;
        }
    </style>
</head>
<body>
    <button onclick="toggleMode()" style="position:absolute;top:20px;right:20px;width:auto;padding:10px 20px;">Dark/Light Mode</button>

    <div style="position:absolute; top:15px; left:20px; font-size:24px; font-weight:bold; 
    color:#ffffff; background:#003366; padding:8px 16px; border-radius:12px; 
    box-shadow:0 0 10px rgba(0,0,0,0.4); display:flex; align-items:center; gap:8px;">
    <span style="font-size:22px;">ðŸ”°</span> LegoTax
</div>

    <h1 style="text-align:center;">Pre-Paid Calculator</h1>
    

    <div class="container">
        <label>Insurance Name:</label>
        <input type="text" id="name">

        <label>Purchase Date:</label>
        <input type="date" id="date">

        <label>Insurance Amount:</label>
        <input type="number" id="amount">

        <label>Policy Duration (Years):</label>
        <input type="number" id="duration" value="1">

        <label>Financial Year Start:</label>
        <input type="date" id="fyStart" value="2024-04-01">

        <label>Financial Year End:</label>
        <input type="date" id="fyEnd" value="2025-03-31">

        <button onclick="calculate()">CALCULATE</button>
        <button onclick="clearAll()" style="background:red;color:white;">CLEAR ALL</button>
        <button onclick="window.print()" style="background:green;color:white;">PRINT</button>
        <button onclick="exportExcel()" style="background:#cc9900;color:white;">EXPORT TO EXCEL</button>
    </div>

    <table id="resultTable">
        <thead>
            <tr>
                <th>Insurance Name</th>
                <th>Financial Year</th>
                <th>Amount Used</th>
                <th>Prepaid Balance</th>
            </tr>
        </thead>
        <tbody></tbody>
        <tfoot>
            <tr>
                <th colspan="2">TOTAL</th>
                <th id="totalUsed">0</th>
                <th id="totalPrepaid">0</th>
            </tr>
        </tfoot>
    </table>

    <footer>
        Â© LegoTax | Designed & Developed by Mitanshu
    </footer>

<script>
function calculate() {
    const name = document.getElementById("name").value;
    const amount = parseFloat(document.getElementById("amount").value);
    const start = new Date(document.getElementById("date").value);

    let end = new Date(start);
    end.setFullYear(end.getFullYear() + parseInt(document.getElementById("duration").value));

    const fyStart = new Date(document.getElementById("fyStart").value);
    const fyEnd = new Date(document.getElementById("fyEnd").value);

    const totalDays = (end - start) / (1000 * 60 * 60 * 24);
    const perDay = amount / totalDays;

    let used = 0;
    if (start < fyEnd && end > fyStart) {
        const periodStart = start > fyStart ? start : fyStart;
        const periodEnd = end < fyEnd ? end : fyEnd;
        const daysUsed = (periodEnd - periodStart) / (1000 * 60 * 60 * 24);
        used = perDay * daysUsed;
    }

    const prepaid = amount - used;

    const tbody = document.querySelector('#resultTable tbody');
    const row = `<tr>
        <td>${name}</td>
        <td>${fyStart.getFullYear()}-${fyEnd.getFullYear()}</td>
        <td>${used.toFixed(2)}</td>
        <td>${prepaid.toFixed(2)}</td>
    </tr>`;
    tbody.innerHTML += row;

    updateTotals();
}

function clearAll() {
    document.getElementById("name").value = "";
    document.getElementById("date").value = "";
    document.getElementById("amount").value = "";
    document.querySelector('#resultTable tbody').innerHTML = "";
    updateTotals();
}

function updateTotals() {
    let totalUsed = 0, totalPrepaid = 0;
    document.querySelectorAll('#resultTable tbody tr').forEach(row => {
        totalUsed += parseFloat(row.children[2].innerText);
        totalPrepaid += parseFloat(row.children[3].innerText);
    });

    document.getElementById('totalUsed').innerText = totalUsed.toFixed(2);
    document.getElementById('totalPrepaid').innerText = totalPrepaid.toFixed(2);
}

function toggleMode() {
    document.body.classList.toggle('dark-mode');
}

function exportExcel() {
    let table = document.getElementById("resultTable").outerHTML;
    let blob = new Blob([table], { type: 'application/vnd.ms-excel' });
    let link = document.createElement('a');
    link.href = window.URL.createObjectURL(blob);
    link.download = "LegoTax_Prepaid_Insurance.xlsx";
    link.click();
}
</script>
</body>
</html>
